Most of this code is from libboard_sam3s-ek by ATMEL, with
some modifications and corrections by me.
